import telebot
import random
import datetime

import os
BOT_TOKEN = os.getenv('BOT_TOKEN')

# –°–æ–∑–¥–∞–µ–º –±–æ—Ç–∞
bot = telebot.TeleBot(BOT_TOKEN)

# –°–ø–∏—Å–æ–∫ —à—É—Ç–æ–∫ –¥–ª—è –±–æ—Ç–∞
jokes = [
    "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –Ω–µ –ª—é–±—è—Ç –ø—Ä–∏—Ä–æ–¥—É? –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –±–∞–≥–æ–≤! üêõ",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–∫—É—Ä—Å–∏—è? –°–º–æ—Ç—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∫—É—Ä—Å–∏–∏ üîÑ",
    "–ü–æ—á–µ–º—É Java-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–æ—Å—è—Ç –æ—á–∫–∏? –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –≤–∏–¥—è—Ç C# üòé",
    "10 —Ç–∏–ø–æ–≤ –ª—é–¥–µ–π: —Ç–µ, –∫—Ç–æ –ø–æ–Ω–∏–º–∞–µ—Ç –¥–≤–æ–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –∏ —Ç–µ, –∫—Ç–æ –Ω–µ—Ç üòÑ",
    "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–±–∞–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞? –õ–∞–π–∫–∞! üêï"
]

# –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ–∞–∫—Ç–æ–≤
facts = [
    "üß† –ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –º–æ–∑–≥ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 20% –≤—Å–µ–π —ç–Ω–µ—Ä–≥–∏–∏ —Ç–µ–ª–∞",
    "üêô –£ –æ—Å—å–º–∏–Ω–æ–≥–∞ —Ç—Ä–∏ —Å–µ—Ä–¥—Ü–∞ –∏ –≥–æ–ª—É–±–∞—è –∫—Ä–æ–≤—å",
    "üåç –û–¥–∏–Ω –¥–µ–Ω—å –Ω–∞ –í–µ–Ω–µ—Ä–µ –¥–ª–∏—Ç—Å—è –¥–æ–ª—å—à–µ, —á–µ–º –≥–æ–¥ –Ω–∞ –í–µ–Ω–µ—Ä–µ",
    "üêù –ü—á–µ–ª—ã –º–æ–≥—É—Ç —Å—á–∏—Ç–∞—Ç—å –¥–æ —á–µ—Ç—ã—Ä–µ—Ö",
    "üéµ –°–µ—Ä–¥—Ü–µ –∫–∏—Ç–∞ –±—å–µ—Ç—Å—è —Ç–∞–∫ –º–µ–¥–ª–µ–Ω–Ω–æ, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫ –º–æ–≥ –±—ã –ø—Ä–æ–ø–æ–ª–∑—Ç–∏ —á–µ—Ä–µ–∑ –µ–≥–æ –∞—Ä—Ç–µ—Ä–∏–∏"
]

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def start_message(message):
    bot.send_message(
        message.chat.id,
        f"–ü—Ä–∏–≤–µ—Ç, {message.from_user.first_name}! üëã\n\n"
        "–Ø –ø—Ä–æ—Å—Ç–æ–π –±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫. –í–æ—Ç —á—Ç–æ —è —É–º–µ—é:\n\n"
        "üîπ /help - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã\n"
        "üîπ /joke - —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å —à—É—Ç–∫—É\n"
        "üîπ /fact - –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\n"
        "üîπ /time - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Ä–µ–º—è\n"
        "üîπ /weather - —É–∑–Ω–∞—Ç—å '–ø–æ–≥–æ–¥—É' (—à—É—Ç–∫–∞)\n"
        "üîπ /roll - –±—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫\n\n"
        "–¢–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ —á—Ç–æ-–Ω–∏–±—É–¥—å! üòä"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
@bot.message_handler(commands=['help'])
def help_message(message):
    bot.send_message(
        message.chat.id,
        "üìù –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:\n\n"
        "üîπ /start - –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ\n"
        "üîπ /help - –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ\n"
        "üîπ /joke - —Å–ª—É—á–∞–π–Ω–∞—è —à—É—Ç–∫–∞\n"
        "üîπ /fact - –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç\n"
        "üîπ /time - —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è\n"
        "üîπ /weather - '–ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã'\n"
        "üîπ /roll - –±—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫ (1-6)\n\n"
        "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ —á—Ç–æ-–Ω–∏–±—É–¥—å, –∏ —è –æ—Ç–≤–µ—á—É! üí¨"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /joke
@bot.message_handler(commands=['joke'])
def joke_message(message):
    random_joke = random.choice(jokes)
    bot.send_message(message.chat.id, f"üòÑ {random_joke}")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /fact
@bot.message_handler(commands=['fact'])
def fact_message(message):
    random_fact = random.choice(facts)
    bot.send_message(message.chat.id, f"üí° –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç:\n{random_fact}")

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /time
@bot.message_handler(commands=['time'])
def time_message(message):
    current_time = datetime.datetime.now().strftime("%H:%M:%S")
    current_date = datetime.datetime.now().strftime("%d.%m.%Y")
    bot.send_message(
        message.chat.id,
        f"üïê –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: {current_time}\n"
        f"üìÖ –î–∞—Ç–∞: {current_date}"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /weather
@bot.message_handler(commands=['weather'])
def weather_message(message):
    weather_variants = [
        "‚òÄÔ∏è –°–æ–ª–Ω–µ—á–Ω–æ –∏ —Ç–µ–ø–ª–æ! –û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –ø—Ä–æ–≥—É–ª–∫–∏",
        "üåßÔ∏è –î–æ–∂–¥–ª–∏–≤–æ... –õ—É—á—à–µ –≤–∑—è—Ç—å –∑–æ–Ω—Ç",
        "‚ùÑÔ∏è –°–Ω–µ–∂–Ω–æ –∏ –º–æ—Ä–æ–∑–Ω–æ! –û–¥–µ–≤–∞–π—Ç–µ—Å—å —Ç–µ–ø–ª–µ–µ",
        "üå§Ô∏è –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±–ª–∞—á–Ω–æ—Å—Ç—å, –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –Ω–µ–ø–ª–æ—Ö–æ",
        "üå™Ô∏è –£—Ä–∞–≥–∞–Ω! –õ—É—á—à–µ –æ—Å—Ç–∞—Ç—å—Å—è –¥–æ–º–∞ (—à—É—á—É)",
        "üåà –ü–æ—Å–ª–µ –¥–æ–∂–¥–∏—á–∫–∞ –≤ —á–µ—Ç–≤–µ—Ä–≥ - –ø–æ—è–≤–∏–ª–∞—Å—å —Ä–∞–¥—É–≥–∞!"
    ]
    fake_weather = random.choice(weather_variants)
    bot.send_message(
        message.chat.id,
        f"üåç –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã:\n{fake_weather}\n\n"
        "üí° –≠—Ç–æ —à—É—Ç–æ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑! –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ–≥–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è üòä"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /roll
@bot.message_handler(commands=['roll'])
def roll_message(message):
    dice_result = random.randint(1, 6)
    dice_emoji = ["", "‚öÄ", "‚öÅ", "‚öÇ", "‚öÉ", "‚öÑ", "‚öÖ"]
    bot.send_message(
        message.chat.id,
        f"üé≤ –ö—É–±–∏–∫ –±—Ä–æ—à–µ–Ω!\n"
        f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {dice_emoji[dice_result]} ({dice_result})"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(content_types=['text'])
def text_message(message):
    user_text = message.text.lower()
    
    # –ü—Ä–æ—Å—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ—Ä–∞–∑—ã
    responses = {
        "–ø—Ä–∏–≤–µ—Ç": "–ü—Ä–∏–≤–µ—Ç! üëã –ö–∞–∫ –¥–µ–ª–∞?",
        "–ø–æ–∫–∞": "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! üëã –ë—ã–ª–æ –ø—Ä–∏—è—Ç–Ω–æ –ø–æ–æ–±—â–∞—Ç—å—Å—è!",
        "–∫–∞–∫ –¥–µ–ª–∞": "–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ! üòä –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º!",
        "—Å–ø–∞—Å–∏–±–æ": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! üòä –í—Å–µ–≥–¥–∞ —Ä–∞–¥ –ø–æ–º–æ—á—å!",
        "—á—Ç–æ —É–º–µ–µ—à—å": "–Ø —É–º–µ—é —à—É—Ç–∏—Ç—å, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ñ–∞–∫—Ç—ã, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ! –ù–∞–ø–∏—à–∏—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥",
        "–∫—Ç–æ —Ç—ã": "–Ø –ø—Ä–æ—Å—Ç–æ–π –±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫! ü§ñ –°–æ–∑–¥–∞–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ä–∞–∑–≤–ª–µ–∫–∞—Ç—å –∏ –ø–æ–º–æ–≥–∞—Ç—å",
    }
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    for key, response in responses.items():
        if key in user_text:
            bot.send_message(message.chat.id, response)
            return
    
    # –ï—Å–ª–∏ –Ω–µ—Ç –≥–æ—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞, –æ—Ç–≤–µ—á–∞–µ–º –¥—Ä—É–∂–µ–ª—é–±–Ω–æ
    bot.send_message(
        message.chat.id,
        f"–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! ü§î –í—ã –Ω–∞–ø–∏—Å–∞–ª–∏: '{message.text}'\n\n"
        "–Ø –ø–æ–∫–∞ –Ω–µ –∑–Ω–∞—é, –∫–∞–∫ –Ω–∞ —ç—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ:\n"
        "‚Ä¢ –ù–∞–ø–∏—Å–∞—Ç—å /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥\n"
        "‚Ä¢ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å /joke –¥–ª—è —à—É—Ç–∫–∏\n"
        "‚Ä¢ –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–æ–±–æ–ª—Ç–∞—Ç—å —Å–æ –º–Ω–æ–π! üòä"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
@bot.message_handler(content_types=['photo', 'video', 'audio', 'document', 'sticker'])
def media_message(message):
    media_types = {
        'photo': '—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é üì∏',
        'video': '–≤–∏–¥–µ–æ üé•',
        'audio': '–∞—É–¥–∏–æ üéµ',
        'document': '–¥–æ–∫—É–º–µ–Ω—Ç üìÑ',
        'sticker': '—Å—Ç–∏–∫–µ—Ä üòä'
    }
    
    media_type = media_types.get(message.content_type, '—Ñ–∞–π–ª')
    bot.send_message(
        message.chat.id,
        f"–°–ø–∞—Å–∏–±–æ –∑–∞ {media_type}! üòä\n\n"
        "–Ø –ø–æ–∫–∞ –Ω–µ —É–º–µ—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã, –Ω–æ –º–æ–≥—É:\n"
        "‚Ä¢ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è\n"
        "‚Ä¢ –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã (–Ω–∞–ø–∏—à–∏—Ç–µ /help)\n"
        "‚Ä¢ –ü–æ–±–æ–ª—Ç–∞—Ç—å —Å –≤–∞–º–∏! üí¨"
    )

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞
def main():
    print("ü§ñ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!")
    print("üìù –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C")
    
    try:
        bot.polling(none_stop=True)
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        print("üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞...")
        main()

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
if __name__ == "__main__":
    main()